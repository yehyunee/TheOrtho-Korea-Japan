<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>WEBCEPH 미니 인증 코스 — 즉시 등록</title>
  <meta name="description" content="WEBCEPH 미니 인증 코스 — 등록/결제, 행사 이미지, 프로그램, 장소 정보" />
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css"/>
  <style>
    :root { --accent: #332CF5; }
    .btn-accent{ background:var(--accent); color:#fff; }
    .btn-accent:hover{ filter:brightness(0.92); }
    .text-accent{ color:var(--accent); }
    .border-accent{ border-color:var(--accent); }
    html { scroll-behavior:smooth; }
    body {
      background-image: url('images/pattern.PNG');
      background-repeat: repeat;
      background-position: top left;
      background-attachment: fixed; /* 스크롤 시 고정 */
    }
  </style>
</head>
<body class="bg-slate-50 text-slate-800">

  <!-- Nav (Compact anchors) -->
  <header class="sticky top-0 z-40 bg-white/90 backdrop-blur border-b border-slate-200">
    <div class="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
      <a href="#top" class="flex items-center gap-2 font-semibold truncate">
        <span class="inline-block w-6 h-6 rounded-lg" style="background:var(--accent)"></span>
        <span class="truncate">WEBCEPH 미니 인증 코스</span>
      </a>

      <div class="relative">
        <button id="menuToggle" class="inline-flex items-center gap-2 px-3 py-2 rounded-lg border border-slate-300 hover:border-accent" aria-haspopup="true" aria-expanded="false" aria-controls="menuPanel">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg>
          <span class="text-sm">Menu</span>
        </button>
        <div id="menuPanel" class="hidden absolute right-0 mt-2 w-56 bg-white/95 backdrop-blur-md border border-slate-200 rounded-xl shadow-xl p-2">
          <nav class="flex flex-col text-sm">
            <a href="#register" class="px-3 py-2 rounded-lg hover:bg-slate-100 font-semibold text-accent">등록</a>
            <a href="#gallery"  class="px-3 py-2 rounded-lg hover:bg-slate-100">이미지</a>
            <a href="#info"     class="px-3 py-2 rounded-lg hover:bg-slate-100">행사 정보</a>
            <a href="#program"  class="px-3 py-2 rounded-lg hover:bg-slate-100">프로그램</a>
            <a href="#venue"    class="px-3 py-2 rounded-lg hover:bg-slate-100">장소</a>
          </nav>
        </div>
      </div>
    </div>
  </header>

  <!-- Top Pane: Register + Slider (mobile = full-width pane, desktop = card) -->
  <main id="top">
    <!-- Top Pane: Register + Slider -->
    <section id="register"
      class="bg-white rounded-none md:rounded-2xl md:shadow border border-slate-200
             md:max-w-5xl md:mx-auto mx-0 my-0 md:my-8 px-4 md:px-0">
      <div class="grid md:grid-cols-2">
        <!-- 폼: min-w-0로 축소 방지 -->
        <div class="py-5 md:p-8 min-w-0">
          <h1 class="text-xl md:text-2xl font-bold mb-4">즉시 등록</h1>
          <form id="fastForm" class="space-y-3" onsubmit="return false;">
            <input name="name" type="text" placeholder="이름" required class="w-full border rounded-lg p-3">
            <input name="email" type="email" placeholder="이메일" required class="w-full border rounded-lg p-3">
            <input name="phone" type="tel" placeholder="전화번호" required class="w-full border rounded-lg p-3">
            <input name="affiliation" type="text" placeholder="소속 (선택)" class="w-full border rounded-lg p-3">
            <div class="flex items-center gap-2 text-xs text-slate-600">
              <input id="agree" type="checkbox" class="h-4 w-4" required>
              <label for="agree">개인정보 수집·이용에 동의합니다.</label>
            </div>

            <div class="grid grid-cols-1 gap-2 pt-2">
              <!-- Iamport -->
              <button id="btnIamport" type="button" class="px-4 py-3 rounded-lg font-semibold btn-accent">아임포트 결제</button>
              <!-- PayPal Express 링크 버튼 (폼 내 결제 버튼 목록에 추가) -->
              <a href="https://paypal.me/YOUR_ID/80USD" target="_blank"
                 class="px-4 py-3 rounded-lg text-center border border-slate-300">
                PayPal Express 결제
              </a>


              <details class="text-sm text-slate-600 border border-slate-200 rounded-lg p-3">
                <summary class="cursor-pointer font-medium">무통장 입금 안내 (선택)</summary>
                <p class="mt-2">예금주: ㈜웹셉 | 은행: OO은행 | 계좌: 000-0000-0000</p>
                <p class="mt-1">입금 후 등록 확인을 위해 이름/입금자명/전화번호를 등록폼에 정확히 입력해주세요.</p>
              </details>
            </div>

            <div id="resultBox" class="hidden mt-3 p-3 border rounded-lg">
              <p class="font-semibold">결제가 접수되었습니다.</p>
              <p class="text-sm text-slate-600">확인 메일은 서버 검증 후 발송됩니다. 아래 임시 QR은 현장 테스트용입니다.</p>
              <div id="qrTicket" class="mt-2 flex items-center justify-center h-40"></div>
            </div>
          </form>
        </div>

        <!-- 슬라이드: 전체 이미지가 보이도록 contain + 중앙정렬 -->
        <div id="gallery" class="relative min-w-0">
          <!-- 모바일: 4:3 비율 / 데스크탑: 고정 높이로 안정화 -->
          <div class="relative w-full aspect-[3/4] md:aspect-auto md:h-[650px]">
            <div class="swiper absolute inset-0 w-full h-full">
              <div class="swiper-wrapper">
                <div class="swiper-slide flex items-center justify-center bg-black/5">
                  <img src="images/benefit1.png"
                       alt="대표 이미지 1"
                       class="max-w-full max-h-full w-auto h-auto object-contain block">
                </div>
                <div class="swiper-slide flex items-center justify-center bg-black/5">
                  <img src="images/benefit2.png"
                       alt="대표 이미지 2"
                       class="max-w-full max-h-full w-auto h-auto object-contain block">
                </div>
                <!-- 필요하면 더 추가 -->
                <!--
                <div class="swiper-slide flex items-center justify-center bg-black/5">
                  <img src="images/benefit3.png"
                       alt="대표 이미지 3"
                       class="max-w-full max-h-full w-auto h-auto object-contain block">
                </div>
                -->
              </div>
              <div class="swiper-pagination"></div>
            </div>
          </div>
        </div>

      </div>
    </section>


    <!-- Event Info (single panel) -->
    <section id="info" class="bg-white rounded-none md:rounded-2xl md:shadow border border-slate-200 md:max-w-5xl md:mx-auto mx-0 mt-6 md:mt-8">
      <div class="px-5 md:px-8 py-6">
        <p class="text-xs tracking-widest font-semibold text-slate-500 mb-2" style="color:color-mix(in oklab, var(--accent) 60%, black 40%);">EVENT INFO</p>
        <div class="grid md:grid-cols-4 gap-4 text-sm">
          <div><div class="text-slate-500">일시</div><div class="font-semibold">2025-10-28 (화) 18:30–21:00</div></div>
          <div><div class="text-slate-500">장소</div><div class="font-semibold">스페이스쉐어 삼성역센터 컨퍼런스홀, 서울</div></div>
          <div><div class="text-slate-500">주최</div><div class="font-semibold">WEBCEPH</div></div>
          <div><div class="text-slate-500">언어</div><div class="font-semibold">Korean · Japanese</div></div>
        </div>
        <div class="mt-4 flex flex-wrap gap-2">
          <a id="mapBtn" href="#" target="_blank" class="inline-flex items-center gap-2 px-4 py-2 rounded-lg border border-slate-300 text-sm">지도 열기</a>
          <a id="icsBtn" href="#" class="inline-flex items-center gap-2 px-4 py-2 rounded-lg text-sm btn-accent">캘린더 저장 (.ics)</a>
        </div>
      </div>
    </section>

    <!-- Program -->
    <section id="program" class="md:max-w-5xl md:mx-auto mx-0 mt-6 md:mt-8">
      <div class="px-5 md:px-0">
        <h2 class="text-lg md:text-xl font-bold mb-3 text-white">프로그램</h2>
        <!-- Mobile: cards -->
        <div class="md:hidden space-y-3">
          <div class="p-3 border rounded-lg bg-white"><p class="text-xs text-slate-500">18:30–18:40</p><p>인사 및 소개</p></div>
          <div class="p-3 border rounded-lg bg-white"><p class="text-xs text-slate-500">18:40–19:10</p><p>Dr. Hiroyuki Watabe — 투명교정 시 추가 얼라이너를 줄이기 위한 전략</p></div>
          <div class="p-3 border rounded-lg bg-white"><p class="text-xs text-slate-500">19:10–19:40</p><p>Dr. Shuichiro Okano &amp; Dr. Takao Minamide — Aligner Radio in Korea</p></div>
          <div class="p-3 border rounded-lg bg-white"><p class="text-xs text-slate-500">19:40–19:50</p><p>Q&amp;A</p></div>
          <div class="p-3 border rounded-lg bg-white"><p class="text-xs text-slate-500">19:50–20:20</p><p>Dr. 김예현 — WEBCEPH 미니 인증 코스</p></div>
          <div class="p-3 border rounded-lg bg-white"><p class="text-xs text-slate-500">20:20–20:50</p><p>Dr. 최형주 — 투명 교정: 치료계획에서의 난관과 해결책</p></div>
          <div class="p-3 border rounded-lg bg-white"><p class="text-xs text-slate-500">20:50–21:00</p><p>Q&amp;A 및 단체 사진 촬영</p></div>
        </div>
        <!-- Desktop: table -->
        <div class="hidden md:block overflow-x-auto">
          <table class="w-full border border-slate-200 rounded-2xl overflow-hidden shadow text-white">
            <thead class="bg-white/20 text-white">
              <tr>
                <th class="px-4 py-2 text-left w-32">시간</th>
                <th class="px-4 py-2 text-left">내용</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-slate-400/50">
              <tr><td class="px-4 py-2">18:30–18:40</td><td class="px-4 py-2">인사 및 소개</td></tr>
              <tr><td class="px-4 py-2">18:40–19:10</td><td class="px-4 py-2">Dr. Hiroyuki Watabe — 투명교정 시 추가 얼라이너를 줄이기 위한 전략</td></tr>
              <tr><td class="px-4 py-2">19:10–19:40</td><td class="px-4 py-2">Dr. Shuichiro Okano &amp; Dr. Takao Minamide — Aligner Radio in Korea</td></tr>
              <tr><td class="px-4 py-2">19:40–19:50</td><td class="px-4 py-2">Q&amp;A</td></tr>
              <tr><td class="px-4 py-2">19:50–20:20</td><td class="px-4 py-2">Dr. 김예현 — WEBCEPH 미니 인증 코스</td></tr>
              <tr><td class="px-4 py-2">20:20–20:50</td><td class="px-4 py-2">Dr. 최형주 — 투명 교정: 치료계획에서의 난관과 해결책</td></tr>
              <tr><td class="px-4 py-2">20:50–21:00</td><td class="px-4 py-2">Q&amp;A 및 단체 사진 촬영</td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- Venue anchor (map opens from info section) -->
    <div id="venue" class="h-8"></div>
  </main>

  <footer class="py-10">
    <div class="max-w-6xl mx-auto px-4 text-sm text-slate-500">© 2025 WEBCEPH. All rights reserved.</div>
  </footer>

  <!-- Libs -->
  <script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>
  <script src="https://cdn.iamport.kr/js/iamport.payment-1.2.0.js"></script>
  <script src="https://www.paypal.com/sdk/js?client-id=YOUR_PAYPAL_CLIENT_ID&currency=USD"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

  <script>
    // === Menu toggle ===
    (function () {
      const btn = document.getElementById('menuToggle');
      const panel = document.getElementById('menuPanel');
      function closeMenu(){ panel.classList.add('hidden'); btn.setAttribute('aria-expanded','false'); }
      function openMenu(){ panel.classList.remove('hidden'); btn.setAttribute('aria-expanded','true'); }
      btn?.addEventListener('click', (e)=>{ e.stopPropagation(); (btn.getAttribute('aria-expanded')==='true')?closeMenu():openMenu(); });
      document.addEventListener('click', (e)=>{ if(!panel.contains(e.target) && !btn.contains(e.target)) closeMenu(); });
      document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closeMenu(); });
    })();

    // === Swiper ===
    new Swiper('.swiper', { loop:true, slidesPerView:1, spaceBetween:12, pagination:{ el:'.swiper-pagination', clickable:true } });

    // === Map & ICS ===
    (function(){
      const mapBtn = document.getElementById('mapBtn');
      if (mapBtn) mapBtn.href = 'https://maps.google.com/?q=서울%20강남구%20영동대로96길%2020%20스페이스쉐어%20삼성역센터%20컨퍼런스홀';
      const icsBtn = document.getElementById('icsBtn');
      if (icsBtn) {
        const ics = `BEGIN:VCALENDAR\nVERSION:2.0\nPRODID:-//WEBCEPH//SEMINAR//KR\nBEGIN:VEVENT\nUID:${Date.now()}@webceph\nDTSTAMP:20250829T090000Z\nDTSTART:20251028T093000Z\nDTEND:20251028T120000Z\nSUMMARY:WEBCEPH Mini Certification — Masterclass\nLOCATION:Spaceshare Samseong Center, Seoul\nDESCRIPTION:WEBCEPH live seminar.\nEND:VEVENT\nEND:VCALENDAR`;
        icsBtn.addEventListener('click', (e)=>{
          e.preventDefault(); const blob = new Blob([ics], {type:'text/calendar;charset=utf-8'});
          const url = URL.createObjectURL(blob); const a=document.createElement('a');
          a.href=url; a.download='webceph-seminar-2025-10-28.ics'; a.click(); URL.revokeObjectURL(url);
        });
      }
    })();

    // === Utility: simple hash for local QR payload ===
    function simpleHash(s){ let h=0; for(let i=0;i<s.length;i++){ h=(h<<5)-h+s.charCodeAt(i); h|=0; } return Math.abs(h).toString(36); }
    function showLocalSuccessAndQR(formData, provider, receipt){
      const box = document.getElementById('resultBox');
      box.classList.remove('hidden');
      const payload = { t:'ticket', provider, receipt, name:formData.name, email:formData.email, phone:formData.phone, h:simpleHash(formData.email+'|'+(receipt?.imp_uid||receipt?.id||Date.now())) };
      const target = document.getElementById('qrTicket'); target.innerHTML='';
      new QRCode(target, { text: JSON.stringify(payload), width: 160, height: 160 });
      // TODO: 서버 연동 시, 여기서 서버에 전달하고 서버가 메일 발송/실제 QR 발급
    }

    function getFormData(){
      const f = document.getElementById('fastForm');
      return { name:f.name.value.trim(), email:f.email.value.trim(), phone:f.phone.value.trim(), affiliation:f.affiliation.value.trim() };
    }

    // === Iamport (client-side demo; 실제 검증은 서버에서 ===)
    const IMP = window.IMP; if (IMP) { IMP.init('impXXXXXXXX'); /* TODO: 가맹점 식별코드 */ }
    document.getElementById('btnIamport').addEventListener('click', function(){
      if (!document.getElementById('agree').checked) { alert('개인정보 동의가 필요합니다.'); return; }
      const data = getFormData(); if (!data.name || !data.email || !data.phone) { alert('필수 정보를 입력하세요.'); return; }
      if (!window.IMP) { alert('결제 라이브러리를 불러오지 못했습니다.'); return; }
      window.IMP.request_pay({
        pg: 'html5_inicis',            // TODO: PG사 설정 (예: html5_inicis, kcp, uplus, danal 등)
        pay_method: 'card',
        merchant_uid: 'order_' + Date.now(),
        name: 'WEBCEPH 미니 인증 코스',
        amount: 100000,                // KRW
        buyer_email: data.email,
        buyer_name: data.name,
        buyer_tel: data.phone
      }, function(rsp){
        if (rsp.success) {
          // TODO: 서버에 imp_uid 전달하여 결제 검증 → 성공 시 이메일/정식 QR 발송
          showLocalSuccessAndQR(data, 'iamport', rsp);
        } else {
          alert('결제가 실패했습니다: ' + (rsp.error_msg||'오류'));
        }
      });
    });

    // === PayPal (client-side Buttons; 실제 검증은 서버에서) ===
    if (window.paypal) {
      paypal.Buttons({
        style: { layout: 'horizontal', color: 'gold', shape: 'rect', label: 'paypal' },
        createOrder: function(data, actions){
          // 금액/통화는 계정/정책에 맞게 조정하세요 (예: USD 80.00)
          return actions.order.create({ purchase_units: [{ amount: { value: '80.00', currency_code: 'USD' }, description: 'WEBCEPH Mini Certification' }] });
        },
        onApprove: function(data, actions){
          return actions.order.capture().then(function(details){
            const formData = getFormData();
            if (!formData.name || !formData.email || !formData.phone) {
              alert('결제 전 등록 정보를 입력해주세요.'); return;
            }
            // TODO: 서버에 orderID/결제정보 전달 → 검증 후 이메일/정식 QR 발송
            showLocalSuccessAndQR(formData, 'paypal', details);
          });
        },
        onError: function(err){ alert('PayPal 오류: ' + err); }
      }).render('#paypal-container');
    }
  </script>
</body>
</html>

